<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>å»å“ªç©åƒä»€éº¼ï½œæ„›åƒç†Šæ¨è–¦</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      margin: 0;
      padding: 0;
      background: #fff3d8;
      font-family: "Noto Sans TC", -apple-system, BlinkMacSystemFont, sans-serif;
    }

    .app-wrap {
      max-width: 480px;
      margin: 0 auto;
      padding: 16px;
    }

    .card {
      background: #fffbf2;
      border-radius: 18px;
      border: 2px solid #f0c57a;
      box-shadow: 0 4px 10px rgba(0,0,0,0.08);
      padding: 16px;
      position: relative;
      overflow: hidden;
    }

    /* å°é¢åœ– */
    .banner {
      border-radius: 16px;
      overflow: hidden;
      margin-bottom: 10px;
      border: 2px solid #f0c57a;
    }
    .banner img {
      display: block;
      width: 100%;
      height: auto;
    }

    .title-text h1 {
      margin: 6px 0 0;
      font-size: 20px;
      color: #7a4329;
      text-align: center;
    }
    .title-text p {
      margin: 4px auto 10px;
      font-size: 13px;
      color: #9b5b36;
      text-align: center;
    }

    /* ç†Šç†Šæ°£æ³¡ï¼ˆé»æ“Šæ›å°èªï¼‰ */
    .bubble {
      position: relative;
      margin-top: 4px;
      background: #fff;
      border-radius: 14px;
      padding: 10px 12px;
      border: 2px solid #f7cfa4;
      font-size: 13px;
      color: #6a3b3b;
      cursor: pointer;
    }
    .bubble::after {
      content: "";
      position: absolute;
      left: 26px;
      top: 100%;
      border-width: 8px;
      border-style: solid;
      border-color: #f7cfa4 transparent transparent transparent;
    }
    .bubble::before {
      content: "";
      position: absolute;
      left: 27px;
      top: calc(100% - 2px);
      border-width: 8px;
      border-style: solid;
      border-color: #fff transparent transparent transparent;
    }

    /* ä¸Šæ–¹ Tabï¼šå»å“ªç© / åƒä»€éº¼ */
    .tabs {
      margin-top: 14px;
      display: flex;
      background: #ffe6c5;
      padding: 4px;
      border-radius: 999px;
      gap: 4px;
    }
    .tab-btn {
      flex: 1;
      border-radius: 999px;
      border: none;
      padding: 8px 0;
      font-size: 14px;
      background: transparent;
      color: #9b5b36;
      cursor: pointer;
      font-weight: 600;
      transition: 0.15s ease;
    }
    .tab-btn.active {
      background: #ffffff;
      color: #7a4329;
      box-shadow: 0 3px 8px rgba(0,0,0,0.12);
    }

    .tab-panel {
      margin-top: 12px;
      display: none;
    }
    .tab-panel.active {
      display: block;
    }

    /* åœ°åœ–é¸æ“‡å€ï¼šå°ç£åœ– + å€åŸŸæŒ‰éˆ• */
    .map-select-section {
      display: flex;
      gap: 10px;
      margin-top: 4px;
      align-items: center;
    }

    .map-box {
      position: relative;
      flex: 0 0 48%;
      max-width: 48%;
      border-radius: 16px;
      overflow: hidden;
      border: 2px solid #f0c57a;
      background: #ffe4b7;
    }
    .map-box img {
      display: block;
      width: 100%;
      height: auto;
    }

    .map-btn {
      position: absolute;
      border: none;
      border-radius: 999px;
      padding: 4px 8px;
      font-size: 11px;
      background: rgba(255,255,255,0.9);
      color: #7a4329;
      cursor: pointer;
      box-shadow: 0 2px 6px rgba(0,0,0,0.15);
      border: 1px solid #f0c57a;
      transition: 0.1s ease;
    }
    .map-btn.active {
      background: #ffcf84;
      color: #4b2612;
      transform: translateY(-1px);
    }
    .map-btn.north   { top: 6%;  left: 50%; transform: translateX(-50%); }
    .map-btn.central { top: 38%; left: 52%; transform: translateX(-50%); }
    .map-btn.south   { bottom: 8%; left: 52%; transform: translateX(-50%); }
    .map-btn.east    { top: 42%; right: 4%; }
    .map-btn.islands { bottom: 4%; left: 8%; }
    .map-btn.all     { top: 4%; right: 6%; }

    .map-side-controls {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 10px;
      font-size: 13px;
      color: #7a4329;
    }

    .label {
      font-weight: 700;
      margin-bottom: 2px;
    }

    .pill-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .pill-btn {
      border-radius: 999px;
      border: 1.5px solid #e2b28c;
      background: #fff;
      padding: 5px 10px;
      font-size: 12px;
      color: #74412c;
      cursor: pointer;
      transition: 0.1s ease;
    }
    .pill-btn.active {
      background: #ffd79a;
      color: #4b2612;
      border-color: #d28f5d;
      box-shadow: 0 2px 5px rgba(0,0,0,0.13);
      transform: translateY(-1px);
    }

    /* å¤©æ•¸ +/- */
    .days-control {
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .days-display {
      min-width: 44px;
      text-align: center;
      padding: 3px 0;
      border-radius: 999px;
      border: 1.5px solid #e2b28c;
      background: #fff7ea;
      font-size: 13px;
    }
    .days-btn {
      width: 26px;
      height: 26px;
      border-radius: 50%;
      border: none;
      background: #ffb86b;
      color: #fff;
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
      box-shadow: 0 2px 6px rgba(255,140,82,0.45);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* ä¸‹æ–¹æ“ä½œå€ */
    .action-wrap {
      margin-top: 14px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      flex-wrap: wrap;
    }

    .btn-main {
      flex: 1;
      border: none;
      border-radius: 999px;
      padding: 10px 16px;
      background: linear-gradient(135deg, #ffb86b, #ff9b73);
      color: #fff;
      font-weight: 700;
      font-size: 14px;
      letter-spacing: 1px;
      box-shadow: 0 4px 12px rgba(255,140,82,0.45);
      cursor: pointer;
      transition: transform 0.1s ease, box-shadow 0.1s ease;
      white-space: nowrap;
    }
    .btn-main:active {
      transform: translateY(1px);
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    }

    .btn-ghost {
      border-radius: 999px;
      border: 1.5px dashed #e0a86b;
      padding: 9px 12px;
      background: #ffe8c9;
      color: #7a4329;
      font-size: 12px;
      cursor: pointer;
      white-space: nowrap;
    }

    .counter-group {
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-size: 11px;
      color: #9b5b36;
      min-width: 110px;
    }

    /* +1 å‹•ç•« */
    .plus-one {
      position: absolute;
      right: 24px;
      bottom: 52px;
      font-size: 16px;
      color: #ff7b59;
      font-weight: 700;
      opacity: 0;
      transform: translateY(8px);
      pointer-events: none;
    }
    .plus-one.show {
      animation: riseFade 0.9s ease-out forwards;
    }
    @keyframes riseFade {
      0% { opacity: 0; transform: translateY(8px); }
      20% { opacity: 1; }
      100% { opacity: 0; transform: translateY(-20px); }
    }

    /* Loading å°é»é» */
    .loading-line {
      margin-top: 10px;
      display: none;
      align-items: center;
      justify-content: center;
      gap: 6px;
      font-size: 12px;
      color: #9b5b36;
    }
    .dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: #ff9f6b;
      animation: bounce 0.8s infinite alternate;
    }
    .dot:nth-child(2) { animation-delay: 0.15s; }
    .dot:nth-child(3) { animation-delay: 0.3s; }
    @keyframes bounce {
      from { transform: translateY(0); opacity: 0.5; }
      to { transform: translateY(-6px); opacity: 1; }
    }

    /* Modal è¦–çª— */
    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.4);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 999;
    }
    .modal {
      max-width: 420px;
      width: calc(100% - 32px);
      background: #fff7ea;
      border-radius: 18px;
      border: 2px solid #f3c690;
      box-shadow: 0 8px 24px rgba(0,0,0,0.25);
      padding: 14px 16px 16px;
      max-height: 80vh;
      overflow-y: auto;
    }
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      margin-bottom: 6px;
    }
    .modal-title {
      font-size: 16px;
      font-weight: 700;
      color: #7a4329;
    }
    .modal-close {
      border: none;
      background: transparent;
      font-size: 18px;
      cursor: pointer;
      color: #a25a3a;
    }
    .modal-sub {
      font-size: 12px;
      color: #9b5b36;
      margin-bottom: 8px;
    }
    .modal-section-title {
      font-size: 13px;
      font-weight: 700;
      color: #7a4329;
      margin-top: 8px;
      margin-bottom: 4px;
    }
    .tag-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin: 6px 0;
    }
    .tag {
      font-size: 11px;
      padding: 4px 8px;
      border-radius: 999px;
      background: #ffeedd;
      color: #8b4a33;
    }
    .modal-text {
      font-size: 13px;
      color: #6a3b3b;
      line-height: 1.6;
      white-space: pre-line;
    }

    /* ç´€éŒ„ List */
    .history-block-title {
      font-size: 14px;
      font-weight: 700;
      color: #7a4329;
      margin: 4px 0;
    }
    .history-item {
      padding: 6px 0;
      border-bottom: 1px dashed #f1d4aa;
      font-size: 12px;
      color: #7a4329;
    }
    .history-item:last-child {
      border-bottom: none;
    }
    .history-item-head {
      font-weight: 700;
    }
    .history-item-meta {
      font-size: 11px;
      color: #9b5b36;
    }

    @media (max-width: 380px) {
      .map-select-section {
        flex-direction: column;
      }
      .map-box {
        max-width: 100%;
        flex-basis: auto;
        align-self: center;
      }
    }
  </style>
</head>
<body>
  <div class="app-wrap">
    <div class="card">
      <!-- å°é¢åœ– -->
      <div class="banner">
        <img src="images/travel.png" alt="æ„›åƒç†Šå°ç£å‡ºéŠ">
      </div>

      <div class="title-text">
        <h1>å»å“ªç©åƒä»€éº¼</h1>
        <p>æŒ‰å°ç£åœ°åœ–é¸åœ°é»ï¼Œè®“æ„›åƒç†Šå¹«ä½ æŠ½å‡ºæ—…éŠ & ç¾é£Ÿéˆæ„Ÿ ğŸ»</p>
      </div>

      <div class="bubble" id="bubble">
        ğŸ» é»æˆ‘ä¸€ä¸‹ï¼Œè½è½ä»Šå¤©æ„›åƒç†Šçš„å°æç¤ºï½
      </div>

      <!-- åˆ†é ï¼šå»å“ªç© / åƒä»€éº¼ -->
      <div class="tabs">
        <button class="tab-btn active" data-tab="travel">å»å“ªç© ğŸ§³</button>
        <button class="tab-btn" data-tab="food">åƒä»€éº¼ ğŸ´</button>
      </div>

      <!-- å…±åŒçš„åœ°åœ–èˆ‡é¸é …ï¼ˆå…©å€‹åˆ†é å…±ç”¨ï¼‰ -->
      <div class="tab-panel active" id="panel-travel">
        <div class="map-select-section">
          <div class="map-box">
            <!-- ä¸€æ¨£ç”¨ travel.png ç•¶ã€Œç†Šç†Š + å°ç£åœ–ã€ -->
            <img src="images/travel.png" alt="å°ç£åœ°åœ–é¸æ“‡">

            <button class="map-btn north active" data-region="north">åŒ—éƒ¨</button>
            <button class="map-btn central" data-region="central">ä¸­éƒ¨</button>
            <button class="map-btn south" data-region="south">å—éƒ¨</button>
            <button class="map-btn east" data-region="east">æ±éƒ¨</button>
            <button class="map-btn islands" data-region="islands">å¤–å³¶</button>
            <button class="map-btn all" data-region="all">å…¨å°</button>
          </div>

          <div class="map-side-controls">
            <div>
              <div class="label">å‡ºéŠå°è±¡</div>
              <div class="pill-row" id="typeRow">
                <button class="pill-btn active" data-type="all">ä¸é™</button>
                <button class="pill-btn" data-type="family">è¦ªå­</button>
                <button class="pill-btn" data-type="adult">å¤§äººæ”¾é¬†</button>
                <button class="pill-btn" data-type="couple">æƒ…ä¾¶</button>
                <button class="pill-btn" data-type="solo">ä¸€å€‹äºº</button>
              </div>
            </div>

            <div>
              <div class="label">ç©å¹¾å¤©</div>
              <div class="days-control">
                <button class="days-btn" id="dayMinus">-</button>
                <div class="days-display" id="dayDisplay">2 å¤©</div>
                <button class="days-btn" id="dayPlus">+</button>
              </div>
              <div style="font-size:11px;color:#b08a62;margin-top:2px;">
                ï¼ˆ1â€“5 å¤©ï¼Œé è¨­ 2 å¤©å°æ—…è¡Œï¼‰
              </div>
            </div>
          </div>
        </div>

        <div class="action-wrap">
          <button class="btn-main" id="drawTravelBtn">æŠ½æ—…éŠç±¤ âœ¨</button>
          <div class="counter-group">
            <div>ä»Šæ—¥æ—…éŠç±¤ï¼š<span id="countTravel">0</span> æ¬¡</div>
            <div>ä»Šæ—¥ç¾é£Ÿç±¤ï¼š<span id="countFood">0</span> æ¬¡</div>
          </div>
          <button class="btn-ghost" id="historyBtn">æŸ¥çœ‹ç´€éŒ„ ğŸ“š</button>
        </div>

        <div class="loading-line" id="loadingLine">
          æ„›åƒç†Šç¿»æ‰¾éˆæ„Ÿä¸­â€¦
          <div class="dot"></div><div class="dot"></div><div class="dot"></div>
        </div>
      </div>

      <!-- åƒä»€éº¼åˆ†é å…¶å¯¦å…±ç”¨åŒä¸€çµ„æ§åˆ¶ï¼Œåªæ˜¯æŒ‰éˆ•ä¸åŒ -->
      <div class="tab-panel" id="panel-food">
        <p style="font-size:13px;color:#7a4329;margin:6px 0 0;">
          åœ°åœ–ã€å‡ºéŠå°è±¡èˆ‡å¤©æ•¸ä¸€æ¨£æœƒå½±éŸ¿ç¾é£Ÿæ¨è–¦ï¼ˆè¦ªå­å‹å–„ / ç´„æœƒæ°£æ°› / ä¸€å€‹äººç°¡å–®åƒï¼‰ã€‚
        </p>
        <!-- ä¸å†é‡è¤‡åœ°åœ–ï¼Œç›´æ¥é¡¯ç¤ºæç¤º -->
        <div class="action-wrap" style="margin-top:12px;">
          <button class="btn-main" id="drawFoodBtn">æŠ½ç¾é£Ÿç±¤ ğŸ˜‹</button>
          <div class="counter-group">
            <div>ä»Šæ—¥æ—…éŠç±¤ï¼š<span id="countTravel2">0</span> æ¬¡</div>
            <div>ä»Šæ—¥ç¾é£Ÿç±¤ï¼š<span id="countFood2">0</span> æ¬¡</div>
          </div>
          <button class="btn-ghost" id="historyBtn2">æŸ¥çœ‹ç´€éŒ„ ğŸ“š</button>
        </div>

        <div class="loading-line" id="loadingLineFood">
          æ„›åƒç†Šåœ¨æƒ³ä»Šå¤©è¦åƒä»€éº¼â€¦
          <div class="dot"></div><div class="dot"></div><div class="dot"></div>
        </div>
      </div>

      <!-- +1 å‹•ç•« -->
      <div class="plus-one" id="plusOne">+1 âœ¨</div>
    </div>
  </div>

  <!-- æŠ½ç±¤çµæœ Modal -->
  <div class="modal-backdrop" id="resultModal">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-title" id="resultTitle">æ—…éŠç±¤çµæœ</div>
        <button class="modal-close" data-close="resultModal">âœ•</button>
      </div>
      <div class="modal-sub" id="resultSub"></div>

      <div class="modal-section-title">ğŸ“ åœ°é» / ä¸»é¡Œ</div>
      <div class="modal-text" id="resultMain"></div>

      <div class="modal-section-title">ğŸ”– æ¨™ç±¤</div>
      <div class="tag-row" id="resultTags"></div>

      <div class="modal-section-title">ğŸ» æ„›åƒç†Šå°æé†’</div>
      <div class="modal-text" id="resultTip"></div>
    </div>
  </div>

  <!-- ç´€éŒ„ Modal -->
  <div class="modal-backdrop" id="historyModal">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-title">æ—…è¡Œç´€éŒ„</div>
        <button class="modal-close" data-close="historyModal">âœ•</button>
      </div>
      <div class="modal-sub">
        ä»¥ä¸‹æ˜¯ä½ æœ€è¿‘çš„æ—…éŠç±¤ & ç¾é£Ÿç±¤ï¼ˆæœƒè‡ªå‹•å­˜åˆ°ç€è¦½å™¨ï¼Œä¸‹æ¬¡æ‰“é–‹é‚„çœ‹å¾—åˆ°ï¼‰ğŸŒŸ
      </div>

      <div class="history-block-title">ğŸ§³ æ—…éŠç´€éŒ„</div>
      <div id="historyTravelList"></div>

      <div class="history-block-title" style="margin-top:8px;">ğŸ´ ç¾é£Ÿç´€éŒ„</div>
      <div id="historyFoodList"></div>
    </div>
  </div>

  <script>
    // ---- è³‡æ–™å€ï¼šæ™¯é»ï¼ˆå«éƒ¨åˆ†ç§˜å¢ƒï¼‰ã€ç¾é£Ÿ -----------------------------------------------------
    const attractions = [
      // åŒ—éƒ¨
      {
        name: "ä¹ä»½è€è¡— & é‡‘ç“œçŸ³å±±åŸ",
        region: "north", regionLabel: "åŒ—éƒ¨",
        city: "æ–°åŒ—å¸‚ç‘èŠ³å€",
        minDays: 1, maxDays: 2,
        types: ["all","family","adult","couple"],
        tags: ["å±±åŸå··å¼„", "è€è¡—ç¾é£Ÿ", "å¤œæ™¯"],
        tip: "å»ºè­°å…ˆåˆ°é‡‘ç“œçŸ³èµ°èµ°ï¼Œå†å‚æ™šä¸Šä¹ä»½åƒæ™šé¤çœ‹å¤œæ™¯ã€‚å±±ä¸Šæº«å·®å¤§ï¼Œå¯ä»¥å¸¶ä»¶è–„å¤–å¥—å–”ã€‚"
      },
      {
        name: "å¹³æºªç·šå°ç«è»Š + ç§˜å¢ƒç€‘å¸ƒ",
        region: "north", regionLabel: "åŒ—éƒ¨",
        city: "æ–°åŒ—å¸‚å¹³æºªç·šæ²¿ç·š",
        minDays: 1, maxDays: 2,
        types: ["all","family","couple"],
        tags: ["å°ç«è»Š", "å±±æ—ç€‘å¸ƒ", "æ”¾æ…¢æ­¥èª¿"],
        tip: "å¯ä»¥åœ¨å…¶ä¸­ä¸€ç«™ä¸‹è»Šï¼Œèµ°ä¸€å°æ®µå±±è·¯çœ‹çœ‹ç€‘å¸ƒï¼Œå†å›åˆ°å°é®å–æ¯ç†±é£²ï¼Œæ˜¯å¾ˆé©åˆè¦ªå­çš„è¼•é¬†è¡Œç¨‹ã€‚"
      },
      {
        name: "é™½æ˜å±±å†·æ°´å‘ãƒ»æ“å¤©å´—è‰åŸ",
        region: "north", regionLabel: "åŒ—éƒ¨",
        city: "å°åŒ—å¸‚åŒ—æŠ•å€",
        minDays: 1, maxDays: 2,
        types: ["all","family","adult","solo"],
        tags: ["æ­¥é“", "å¤§è‰åŸ", "è¿‘éƒŠç§˜å¢ƒæ„Ÿ"],
        tip: "æ“å¤©å´—çš„å¤§ç‰‡è‰åŸå¾ˆé©åˆé‡é¤ï¼Œè¨˜å¾—åƒåœ¾è‡ªå·±å¸¶èµ°ï¼Œè®“ç‰›ç¾Šå’Œå±±ä¿æŒä¹¾æ·¨ã€‚"
      },
      {
        name: "é‡‘å±±è¬é‡Œæº«æ³‰ + æµ·é‚Šæ•£æ­¥",
        region: "north", regionLabel: "åŒ—éƒ¨",
        city: "æ–°åŒ—å¸‚é‡‘å±±ãƒ»è¬é‡Œ",
        minDays: 1, maxDays: 2,
        types: ["all","adult","couple"],
        tags: ["æµ·æ™¯æº«æ³‰", "æµ·é®®ç¾é£Ÿ", "è¿‘éƒŠæ”¾é¬†"],
        tip: "æ³¡å®Œæº«æ³‰å¾Œåˆ°æµ·é‚Šå¹å¹é¢¨ï¼Œå†å»åƒä¸€æ¡Œæµ·é®®ï¼Œå¤§äººé™å®šçš„æ”¾é¬†è¡Œç¨‹ã€‚"
      },

      // ä¸­éƒ¨
      {
        name: "æ—¥æœˆæ½­ç’°æ¹–å°æ—…è¡Œ",
        region: "central", regionLabel: "ä¸­éƒ¨",
        city: "å—æŠ•ç¸£é­šæ± é„‰",
        minDays: 2, maxDays: 3,
        types: ["all","family","couple"],
        tags: ["æ¹–æ™¯å–®è»Š", "çºœè»Š", "æ…¢æ´»åº¦å‡"],
        tip: "å¯ä»¥ç§Ÿè…³è¸è»Šæ…¢æ…¢ç’°æ¹–ï¼Œæ­é…èˆ¹ç¥¨èˆ‡çºœè»Šï¼Œä¸€æ¬¡æ”¶é›†ä¸ä¸€æ¨£çš„æ—¥æœˆæ½­é¢¨æ™¯ã€‚è¡Œæè¶Šè¼•ï¼Œå¿ƒä¹Ÿè¶Šè¼•ã€‚"
      },
      {
        name: "æ¸…å¢ƒè¾²å ´ & åˆæ­¡å±±è§€æ˜Ÿ",
        region: "central", regionLabel: "ä¸­éƒ¨",
        city: "å—æŠ•ç¸£ä»æ„›é„‰",
        minDays: 2, maxDays: 3,
        types: ["all","family","adult","couple"],
        tags: ["é’é’è‰åŸ", "é«˜å±±æ˜Ÿç©º", "æ¶¼çˆ½é¿æš‘"],
        tip: "ç™½å¤©çœ‹ç¾Šå’©å’©åƒè‰ï¼Œæ™šä¸Šçœ‹æ»¿å¤©æ˜Ÿæ˜Ÿã€‚å±±ä¸Šæº«åº¦åä½ï¼Œè¨˜å¾—å¸¶å¤–å¥—èˆ‡ä¿æš–è¥ªå­ã€‚"
      },
      {
        name: "å°ä¸­å¯©è¨ˆæ–°æ‘ & è‰æ‚Ÿé“",
        region: "central", regionLabel: "ä¸­éƒ¨",
        city: "å°ä¸­å¸‚è¥¿å€ä¸€å¸¶",
        minDays: 1, maxDays: 2,
        types: ["all","adult","couple","solo"],
        tags: ["æ–‡é’æ•£æ­¥", "å’–å•¡ç”œé»", "å¸‚å€è¼•æ—…è¡Œ"],
        tip: "å¾ˆé©åˆé‚Šæ™ƒé‚Šæ‰¾å–œæ­¡çš„åº—å®¶ï¼Œä¸€æ¯å’–å•¡ã€ä¸€å¡Šè›‹ç³•ï¼Œå°±å¯ä»¥å¾…ä¸€å€‹ä¸‹åˆã€‚"
      },
      {
        name: "æºªé ­æ£®æ—éŠæ¨‚å€ç§˜å¢ƒæ­¥é“",
        region: "central", regionLabel: "ä¸­éƒ¨",
        city: "å—æŠ•ç¸£é¹¿è°·é„‰",
        minDays: 1, maxDays: 2,
        types: ["all","family","solo"],
        tags: ["æ£®æ—æµ´", "è¦ªå­æ­¥é“", "å¸æ£®æ—èŠ¬å¤šç²¾"],
        tip: "èµ°è·¯çš„æ™‚å€™å¯ä»¥ç·´ç¿’è½æ¨¹è‘‰çš„è²éŸ³ã€èæ³¥åœŸå‘³ï¼Œè®“äº”æ„Ÿä¸€èµ·æ—…è¡Œã€‚"
      },

      // å—éƒ¨
      {
        name: "å¢¾ä¸æµ·é‚Šè—å¤©å‡æœŸ",
        region: "south", regionLabel: "å—éƒ¨",
        city: "å±æ±ç¸£æ†æ˜¥é®",
        minDays: 2, maxDays: 4,
        types: ["all","family","adult","couple"],
        tags: ["æ²™ç˜æˆ²æ°´", "åœ‹å®¶å…¬åœ’", "æµ·é¢¨å¹é¢¨"],
        tip: "æ—©ä¸Šç©æ°´ã€ä¸‹åˆå¹æµ·é¢¨ã€æ™šä¸Šçœ‹æ˜Ÿæ˜Ÿã€‚è¨˜å¾—é˜²æ›¬èˆ‡è£œå……æ°´ä»½ï¼Œæ›¬é»‘æ²’é—œä¿‚ï¼Œé–‹å¿ƒæœ€é‡è¦ã€‚"
      },
      {
        name: "é«˜é›„é§äºŒãƒ»æ£§è²³åº«æµ·é‚Šæ•£æ­¥",
        region: "south", regionLabel: "å—éƒ¨",
        city: "é«˜é›„å¸‚é¹½åŸ•å€",
        minDays: 1, maxDays: 2,
        types: ["all","family","adult","couple","solo"],
        tags: ["æ¸¯éƒ½å¸‚æ™¯", "æ–‡å‰µå±•", "å¤œæ™¯æ•£æ­¥"],
        tip: "ç™½å¤©é€›å±•è¦½ï¼Œæ™šä¸Šåˆ°æ¸¯é‚Šå¹é¢¨ï¼Œçœ‹èˆ¹å’Œç‡ˆå…‰ç™¼å‘†ä¸€ä¸‹ï¼Œä¹Ÿæ˜¯ä¸€ç¨®ç™‚ç™’ã€‚"
      },
      {
        name: "å°å—è€å®…å··å¼„å°‹å¯¶",
        region: "south", regionLabel: "å—éƒ¨",
        city: "å°å—å¸‚ä¸­è¥¿å€",
        minDays: 2, maxDays: 3,
        types: ["all","family","adult","couple"],
        tags: ["å°åƒå¤©å ‚", "å¤è¹Ÿè€å±‹", "æ…¢æ­¥æ—…è¡Œ"],
        tip: "ä¸è¦æ€¥è‘—æ‰“å‹¾æ‰€æœ‰æ™¯é»ï¼ŒæŒ‘å¹¾å€‹å··å¼„æ…¢æ…¢èµ°ï¼Œè®“æ°£å‘³å’Œè²éŸ³å¸¶ä½ èªè­˜é€™åº§åŸå¸‚ã€‚"
      },
      {
        name: "å˜‰ç¾©é˜¿é‡Œå±±æ—¥å‡ºé›²æµ·",
        region: "south", regionLabel: "å—éƒ¨",
        city: "å˜‰ç¾©ç¸£é˜¿é‡Œå±±é„‰",
        minDays: 2, maxDays: 3,
        types: ["all","family","adult","couple"],
        tags: ["æ£®æ—éµé“", "æ—¥å‡ºé›²æµ·", "å±±æ—ç§˜å¢ƒ"],
        tip: "æ—©èµ·çœ‹æ—¥å‡ºçš„é‚£ä¸€åˆ»ï¼Œå¾ˆé©åˆå°è‡ªå·±èªªä¸€è²ï¼šè¾›è‹¦äº†ï¼Œè¬è¬ä½ é‚„é¡˜æ„æœŸå¾…æ˜å¤©ã€‚"
      },

      // æ±éƒ¨
      {
        name: "èŠ±è“®å¤ªé­¯é–£å³½è°·ä¹‹æ—…",
        region: "east", regionLabel: "æ±éƒ¨",
        city: "èŠ±è“®ç¸£ç§€æ—é„‰",
        minDays: 2, maxDays: 3,
        types: ["all","family","adult","couple"],
        tags: ["å³½è°·æ­¥é“", "å±±æµ·æ™¯ç·»", "è‡ªç„¶ç™‚ç™’"],
        tip: "æ­¥é“å¤šç‚ºçŸ³éšèˆ‡å±±è·¯ï¼Œé‹å­è¦ç©©ï¼Œè…³æ­¥æ”¾æ…¢ã€‚æ¯å¸ä¸€å£æ°£ï¼Œéƒ½æŠŠç…©æƒ±å…ˆæ”¾åœ¨å±±ä¸‹ã€‚"
      },
      {
        name: "èŠ±æ±ç¸±è°·å°é®æ…¢æ—…è¡Œ",
        region: "east", regionLabel: "æ±éƒ¨",
        city: "èŠ±è“®â€“å°æ±ä¸€å¸¶",
        minDays: 3, maxDays: 4,
        types: ["all","family","adult","couple","solo"],
        tags: ["ç¨»ç”°é¢¨æ™¯", "å°é®æ—…é¤¨", "é¨è…³è¸è»Š"],
        tip: "å¯ä»¥æŒ‘ä¸€å…©å€‹å°é®å¤šå¾…ä¸€å¤©ï¼Œè®“è‡ªå·±æœ‰çœŸæ­£ç™¼å‘†çš„æ™‚é–“ã€‚ç™¼å‘†ï¼Œä¹Ÿæ˜¯å¾ˆé‡è¦çš„è¡Œç¨‹ã€‚"
      },
      {
        name: "å°æ±éƒ½è˜­ãƒ»ç§˜å¢ƒæµ·å²¸ç·š",
        region: "east", regionLabel: "æ±éƒ¨",
        city: "å°æ±ç¸£éƒ½è˜­ä¸€å¸¶",
        minDays: 2, maxDays: 3,
        types: ["all","adult","couple","solo"],
        tags: ["æµ·æ™¯å’–å•¡", "è—è¡“èšè½", "å°é…’é¤¨"],
        tip: "é»ƒæ˜åœ¨æµ·é‚Šçœ‹å¤©è‰²è®ŠåŒ–ï¼Œå†åˆ°å°åº—åƒæ±è¥¿ã€è½éŸ³æ¨‚ï¼Œè®“å¿ƒæƒ…è·Ÿè‘—æµ·æµªæ…¢æ…¢å¹³éœã€‚"
      },
      {
        name: "ä¸‰ä»™å°æ—¥å‡º + æˆåŠŸå°æ¼æ¸¯",
        region: "east", regionLabel: "æ±éƒ¨",
        city: "å°æ±ç¸£æˆåŠŸé®",
        minDays: 1, maxDays: 2,
        types: ["all","family","adult","couple"],
        tags: ["æ—¥å‡ºç§˜å¢ƒ", "æµ·å²¸å…¬è·¯", "å°é®æ­¥èª¿"],
        tip: "å¦‚æœå¯ä»¥æ—©èµ·çœ‹ä¸€æ¬¡æ—¥å‡ºï¼Œæœƒç™¼ç¾è‡ªå·±çš„å¿ƒå…¶å¯¦æ¯”æƒ³åƒä¸­æ›´æœ‰åŠ›é‡ã€‚"
      },

      // å¤–å³¶
      {
        name: "æ¾æ¹–è·³å³¶æµ·é¢¨æ—…è¡Œ",
        region: "islands", regionLabel: "å¤–å³¶",
        city: "æ¾æ¹–ç¸£é¦¬å…¬å¸‚ä¸€å¸¶",
        minDays: 3, maxDays: 4,
        types: ["all","family","adult","couple"],
        tags: ["æµ·ä¸Šæ´»å‹•", "ç„æ­¦å²©åœ°å½¢", "å¤œé–“çœ‹æ˜Ÿæ˜Ÿ"],
        tip: "è¡Œç¨‹ä¸è¦å¡å¤ªæ»¿ï¼Œç•™ä¸€äº›æ™‚é–“åªæ˜¯åè‘—çœ‹æµ·ï¼Œè·Ÿè‡ªå·±å¥½å¥½èŠå¤©ã€‚"
      },
      {
        name: "å°ç‰çƒæµ·é¾œæ…¢æ´»æ—¥å¸¸",
        region: "islands", regionLabel: "å¤–å³¶",
        city: "å±æ±ç¸£ç‰çƒé„‰",
        minDays: 2, maxDays: 3,
        types: ["all","family","couple"],
        tags: ["æµ®æ½›çœ‹æµ·é¾œ", "ç’°å³¶æ©Ÿè»Š", "å°å³¶æ­¥èª¿"],
        tip: "è·Ÿæµ·é¾œä¸€æ¨£æ…¢æ…¢æ¸¸ã€æ…¢æ…¢å‘¼å¸ã€‚è¨˜å¾—ä¿æŒè·é›¢ï¼Œä¸æ‰“æ“¾ç‰ å€‘çš„ç”Ÿæ´»ï¼Œå°±æ˜¯æœ€æº«æŸ”çš„ç›¸é‡ã€‚"
      },
      {
        name: "ç¶ å³¶æº«æ³‰èˆ‡å¤œè§€æ¢…èŠ±é¹¿",
        region: "islands", regionLabel: "å¤–å³¶",
        city: "å°æ±ç¸£ç¶ å³¶é„‰",
        minDays: 2, maxDays: 3,
        types: ["all","adult","couple"],
        tags: ["æµ·å²¸é¢¨æ™¯", "æµ·åº•ä¸–ç•Œ", "æµ·é‚Šæº«æ³‰"],
        tip: "æ™šä¸Šå¯ä»¥å®‰æ’å¤œè§€æ¢…èŠ±é¹¿ï¼Œç™½å¤©æ½›æ°´æˆ–æµ®æ½›ã€‚å›åˆ°æ°‘å®¿å¾Œï¼Œå¯«ä¸€è¡Œä»Šå¤©æœ€æ„Ÿè¬çš„äº‹é€çµ¦è‡ªå·±ã€‚"
      }
    ];

    const foods = [
      // åŒ—éƒ¨
      {
        name: "å°åŒ—æ°¸åº·è¡—å°åƒ + èŠ’æœå†°",
        region: "north", regionLabel: "åŒ—éƒ¨",
        city: "å°åŒ—å¸‚å¤§å®‰å€æ°¸åº·è¡—",
        types: ["all","family","adult","couple","solo"],
        tags: ["å°åƒæ•£æ­¥", "å†°å“ç”œé»", "æ·é‹å¯é”"],
        tip: "å¾æ·é‹æ±é–€ç«™èµ°èµ·ï¼Œå…ˆåƒç‰›è‚‰éºµã€å†ä¾†ä¸€ç¢—èŠ’æœå†°ï¼Œæœ€å¾Œå¸¶æ¯é£²æ–™å»å…¬åœ’åè‘—èŠå¤©ã€‚"
      },
      {
        name: "åŸºéš†å»Ÿå£å¤œå¸‚æµ·é®®äº‚åƒ",
        region: "north", regionLabel: "åŒ—éƒ¨",
        city: "åŸºéš†å¸‚ä»æ„›å€",
        types: ["all","family","adult"],
        tags: ["å¤œå¸‚", "æµ·é®®", "åœ¨åœ°å°åƒ"],
        tip: "å…ˆé¸å¥½æƒ³åƒçš„ 3â€“4 æ”¤ï¼Œä¸å¿…æ¯æ”¤éƒ½æ’éšŠï¼Œç•™ä¸€é»è‚šå­çµ¦çªç„¶å‡ºç¾çš„é©šå–œæ”¤ä½ã€‚"
      },
      {
        name: "é™½æ˜å±±å¾Œå±±ç§˜å¢ƒå’–å•¡å»³",
        region: "north", regionLabel: "åŒ—éƒ¨",
        city: "å°åŒ—å¸‚å£«æ—ãƒ»åŒ—æŠ•ä¸€å¸¶",
        types: ["all","adult","couple","solo"],
        tags: ["æ™¯è§€å’–å•¡", "ç´„æœƒæ°£æ°›", "çœ‹å¤œæ™¯"],
        tip: "æ‰¾ä¸€é–“èƒ½çœ‹å¤œæ™¯çš„å’–å•¡å»³ï¼Œæ…¢æ…¢åƒç”œé»ã€èŠèŠå¤©ï¼Œä¹Ÿå¯ä»¥åªæ˜¯é»˜é»˜çœ‹é¢¨æ™¯ã€‚"
      },

      // ä¸­éƒ¨
      {
        name: "é€¢ç”²å¤œå¸‚å‰µæ„ç¾é£Ÿ",
        region: "central", regionLabel: "ä¸­éƒ¨",
        city: "å°ä¸­å¸‚è¥¿å±¯å€",
        types: ["all","family","adult","couple"],
        tags: ["å¤œå¸‚", "å‰µæ„å°åƒ", "å­¸ç”Ÿæœ€æ„›"],
        tip: "å…ˆé€›ä¸€åœˆå†é–‹å§‹è²·ï¼Œå¯ä»¥é¿å…ç¬¬ä¸€æ”¤å°±åƒå¤ªé£½ã€‚å’Œæœ‹å‹è¼ªæµé»ä¸åŒçš„æ±è¥¿åˆ†è‘—åƒæœ€åˆ’ç®—ã€‚"
      },
      {
        name: "å‹¤ç¾ç¶ åœ’é“å’–å•¡ç”œé»",
        region: "central", regionLabel: "ä¸­éƒ¨",
        city: "å°ä¸­å¸‚è¥¿å€",
        types: ["all","adult","couple","solo"],
        tags: ["å’–å•¡ç”œé»", "æ–‡é’è·¯ç·š", "æ•£æ­¥æ”¾ç©º"],
        tip: "æ‰¾ä¸€é–“æœ‰å¤§ç‰‡è½åœ°çª—çš„å’–å•¡å»³ï¼Œè®“è‡ªå·±å…‰æ˜æ­£å¤§åœ°ä»€éº¼äº‹éƒ½ä¸åšï¼Œåªè¦æ…¢æ…¢åƒè›‹ç³•å°±å¥½ã€‚"
      },
      {
        name: "å—æŠ•åŸ”é‡Œé…’å»  & åœ¨åœ°å°åƒ",
        region: "central", regionLabel: "ä¸­éƒ¨",
        city: "å—æŠ•ç¸£åŸ”é‡Œé®",
        types: ["all","family","adult"],
        tags: ["åœ¨åœ°é¢¨å‘³", "ä¼´æ‰‹ç¦®", "é †éŠæ™¯é»"],
        tip: "å¯ä»¥å®‰æ’å–é»ç±³é…’å†°æ·‡æ·‹æˆ–ç”œå“ï¼Œå¤§äººé©é‡å“åšï¼Œå°æœ‹å‹å¯ä»¥åƒç„¡é…’ç²¾çš„ã€‚"
      },

      // å—éƒ¨
      {
        name: "å°å—å··å¼„æ—©é¤ï¼‹å¤æ—©å‘³å°åƒ",
        region: "south", regionLabel: "å—éƒ¨",
        city: "å°å—å¸‚ä¸­è¥¿å€",
        types: ["all","family","adult","couple"],
        tags: ["æ—©åˆé¤", "å¤æ—©å‘³", "å°åƒå¤©å ‚"],
        tip: "å°å—é©åˆå¾æ—©é¤å°±é–‹å§‹åƒï¼Œç‰›è‚‰æ¹¯ã€é‹ç‡’æ„éºµã€é­šæ¹¯è¼ªæµä¾†ã€‚åƒå®Œè¨˜å¾—èµ°é€²å··å­è£¡æ™ƒä¸€åœˆã€‚"
      },
      {
        name: "é«˜é›„é¹½åŸ•å€è€åº—å†°å“ + å°åƒ",
        region: "south", regionLabel: "å—éƒ¨",
        city: "é«˜é›„å¸‚é¹½åŸ•å€",
        types: ["all","family","adult"],
        tags: ["è€å­—è™Ÿ", "å†°å“", "æ¸¯é‚Šæ•£æ­¥"],
        tip: "å†°å“å’Œéºµåº—å¯ä»¥éŒ¯é–‹æ™‚é–“åƒï¼Œåˆ¥å¿˜äº†å»æ„›æ²³æˆ–æ¸¯é‚Šæ•£æ­¥ï¼Œè®“è‚šå­æœ‰é»ç©ºä½è£ç”œé»ã€‚"
      },
      {
        name: "å¢¾ä¸å¤§è¡—å®µå¤œ + æµ·é®®é¤å»³",
        region: "south", regionLabel: "å—éƒ¨",
        city: "å±æ±ç¸£æ†æ˜¥é®",
        types: ["all","family","adult","couple"],
        tags: ["æµ·é®®", "å¤œç”Ÿæ´»", "è§€å…‰è¡—"],
        tip: "å¯ä»¥å…ˆåœ¨æµ·é‚Šçœ‹å®Œå¤•é™½ï¼Œå†åˆ°å¤§è¡—ä¸Šæ…¢æ…¢æ‰¾æƒ³åƒçš„åº—ã€‚è¨˜å¾—å¸¶ä»¶è–„å¤–å¥—é¿å…å—æ¶¼ã€‚"
      },

      // æ±éƒ¨
      {
        name: "èŠ±è“®æ±å¤§é–€å¤œå¸‚åƒä¸€åœˆ",
        region: "east", regionLabel: "æ±éƒ¨",
        city: "èŠ±è“®å¸‚å€",
        types: ["all","family","adult"],
        tags: ["å¤œå¸‚", "åŸä½æ°‘é¢¨å‘³", "éŠæˆ²æ”¤ä½"],
        tip: "å¯ä»¥å…ˆé–å®šå¹¾æ”¤æ’éšŠçš„äººå¤šçš„åº—ï¼Œä½†ä¸è¦å…¨éƒ¨éƒ½åƒç‚¸ç‰©ã€‚ç•™ä¸€ä»½èƒƒçµ¦å¥½åƒçš„éº»ç³¬æˆ–å†°ã€‚"
      },
      {
        name: "èŠ±è“®å£½è±ç§˜å¢ƒæµ·æ™¯å’–å•¡",
        region: "east", regionLabel: "æ±éƒ¨",
        city: "èŠ±è“®ç¸£å£½è±é„‰",
        types: ["all","adult","couple","solo"],
        tags: ["æµ·æ™¯å’–å•¡", "èººæ¤…æ”¾ç©º", "åº¦å‡æ„Ÿ"],
        tip: "å¾ˆé©åˆå¸¶ä¸€æœ¬æ›¸æˆ–ä»€éº¼éƒ½ä¸å¸¶ï¼Œåªæ˜¯çœ‹æµ·ã€è½æµ·æµªï¼Œè®“è…¦è¢‹çŸ­æš«æ”¾å‡ä¸€ä¸‹ã€‚"
      },
      {
        name: "å°æ±é—œå±±ç±³é£Ÿ + å°é®ä¾¿ç•¶",
        region: "east", regionLabel: "æ±éƒ¨",
        city: "å°æ±ç¸£é—œå±±é®",
        types: ["all","family","adult"],
        tags: ["åœ¨åœ°ç±³é£¯", "è»Šç«™ä¾¿ç•¶", "å°é®æ•£æ­¥"],
        tip: "å¯ä»¥æ­é…é¨å–®è»Šç¹é®ä¸€åœˆï¼Œåƒå®Œä¾¿ç•¶å†æ…¢æ…¢é¨ï¼Œäº«å—ç¨»ç”°é¢¨ã€‚"
      },

      // å¤–å³¶
      {
        name: "æ¾æ¹–æµ·é®®å¤§é¤ï¼‹ä»™äººæŒå†°",
        region: "islands", regionLabel: "å¤–å³¶",
        city: "æ¾æ¹–ç¸£é¦¬å…¬å¸‚",
        types: ["all","family","adult"],
        tags: ["æµ·é®®", "åœ¨åœ°ç”œé»", "å³¶å¶¼é¢¨å‘³"],
        tip: "æ–°é®®æµ·é®®å»ºè­°å¤šäººåˆ†äº«ï¼Œå¤§å®¶ä¸€èµ·åˆ†é£Ÿæ¯”è¼ƒèƒ½åƒåˆ°æ›´å¤šç¨®é¡ã€‚æœ€å¾Œä¸€å®šè¦ä¾†ä¸€æ”¯ä»™äººæŒå†°ã€‚"
      },
      {
        name: "å°ç‰çƒå³¶ä¸Šæ—©é¤å·¡ç¦®",
        region: "islands", regionLabel: "å¤–å³¶",
        city: "å±æ±ç¸£ç‰çƒé„‰",
        types: ["all","family","adult"],
        tags: ["å³¶ä¸Šæ—©é¤åº—", "æ‰‹æ–é£²", "æ©Ÿè»Šæ…¢éŠ"],
        tip: "æ—©èµ·é¨è»Šç¹å³¶ï¼Œçœ‹åˆ°å–œæ­¡çš„æ—©é¤åº—å°±åœä¸‹ä¾†ã€‚é‚Šåƒé‚Šçœ‹æµ·ï¼Œä»Šå¤©å°±ç®—éå¾—å¾ˆå……å¯¦äº†ã€‚"
      },
      {
        name: "ç¶ å³¶æµ·é®®ç†±ç‚’ + é¹½é…¥å°é»",
        region: "islands", regionLabel: "å¤–å³¶",
        city: "å°æ±ç¸£ç¶ å³¶é„‰",
        types: ["all","adult","couple"],
        tags: ["ç†±ç‚’", "å®µå¤œ", "æ½›æ°´è¡Œç¨‹æ­é…"],
        tip: "æ½›æ°´æˆ–ç©æ°´å¾Œçš„æ™šé¤ç‰¹åˆ¥å¥½åƒï¼Œä½†ä¹Ÿè¦è¨˜å¾—è£œå……æ°´åˆ†ã€ä¸è¦åƒå¤ªæ’ï¼Œæ˜å¤©æ‰æœ‰é«”åŠ›ç¹¼çºŒç©ã€‚"
      }
    ];

    // ç†Šç†Šå°èª
    const bubbleMessages = [
      "ğŸ» ç†Šç†Šèªªï¼šä¸æ˜¯ä¸€å®šè¦èµ°å¾ˆé ï¼Œèƒ½è®“ä½ è¦ºå¾—æ”¾é¬†çš„åœ°æ–¹ï¼Œå°±æ˜¯å¥½åœ°æ–¹ã€‚",
      "ğŸ» ç†Šç†Šèªªï¼šè¡Œç¨‹æ’ä¸€é»ç©ºç™½ï¼Œè®“é©šå–œæœ‰æ©Ÿæœƒæ’éšŠé€²ä¾†å‘€ã€‚",
      "ğŸ» ç†Šç†Šèªªï¼šç´¯äº†å°±æ…¢ä¸€é»ï¼Œæ—…è¡Œä¸æ˜¯æ¯”é€Ÿåº¦ï¼Œè€Œæ˜¯çœ‹ä½ æœ‰æ²’æœ‰å¥½å¥½æ„Ÿå—ã€‚",
      "ğŸ» ç†Šç†Šèªªï¼šä¸€èµ·åƒé£¯çš„æ™‚å…‰ï¼Œæ¯”åƒåˆ°ä»€éº¼æ›´é‡è¦ã€‚",
      "ğŸ» ç†Šç†Šèªªï¼šå°±ç®—åªæ˜¯ä¸€æ—¥å°æ•£æ­¥ï¼‹è·¯é‚Šå°åƒï¼Œä¹Ÿæ˜¯åœ¨ç‚ºè‡ªå·±å……é›»å–”ã€‚"
    ];

    // ---- DOM ----
    const bubble = document.getElementById("bubble");
    const tabButtons = document.querySelectorAll(".tab-btn");
    const panelTravel = document.getElementById("panel-travel");
    const panelFood = document.getElementById("panel-food");

    const mapBtns = document.querySelectorAll(".map-btn");
    const typeBtns = document.querySelectorAll("#typeRow .pill-btn");
    const dayMinus = document.getElementById("dayMinus");
    const dayPlus = document.getElementById("dayPlus");
    const dayDisplay = document.getElementById("dayDisplay");

    const drawTravelBtn = document.getElementById("drawTravelBtn");
    const drawFoodBtn = document.getElementById("drawFoodBtn");
    const historyBtn = document.getElementById("historyBtn");
    const historyBtn2 = document.getElementById("historyBtn2");

    const loadingLine = document.getElementById("loadingLine");
    const loadingLineFood = document.getElementById("loadingLineFood");

    const countTravel = document.getElementById("countTravel");
    const countFood = document.getElementById("countFood");
    const countTravel2 = document.getElementById("countTravel2");
    const countFood2 = document.getElementById("countFood2");
    const plusOne = document.getElementById("plusOne");

    const resultModal = document.getElementById("resultModal");
    const historyModal = document.getElementById("historyModal");
    const resultTitle = document.getElementById("resultTitle");
    const resultSub = document.getElementById("resultSub");
    const resultMain = document.getElementById("resultMain");
    const resultTags = document.getElementById("resultTags");
    const resultTip = document.getElementById("resultTip");
    const historyTravelList = document.getElementById("historyTravelList");
    const historyFoodList = document.getElementById("historyFoodList");

    // ---- ç‹€æ…‹ / localStorage ----
    const STORAGE_TRAVEL = "luckyg_travel_history";
    const STORAGE_FOOD = "luckyg_food_history";
    let travelHistory = [];
    let foodHistory = [];
    let travelCount = 0;
    let foodCount = 0;

    function loadHistoryFromStorage() {
      try {
        const t = JSON.parse(localStorage.getItem(STORAGE_TRAVEL) || "[]");
        const f = JSON.parse(localStorage.getItem(STORAGE_FOOD) || "[]");
        travelHistory = Array.isArray(t) ? t : [];
        foodHistory = Array.isArray(f) ? f : [];
        travelCount = travelHistory.filter(r => isToday(r.time)).length;
        foodCount = foodHistory.filter(r => isToday(r.time)).length;
        updateCounters();
      } catch (e) {
        travelHistory = [];
        foodHistory = [];
      }
    }

    function saveHistory() {
      localStorage.setItem(STORAGE_TRAVEL, JSON.stringify(travelHistory));
      localStorage.setItem(STORAGE_FOOD, JSON.stringify(foodHistory));
    }

    function isToday(timeStr) {
      const d = new Date(timeStr);
      const now = new Date();
      return d.getFullYear() === now.getFullYear() &&
             d.getMonth() === now.getMonth() &&
             d.getDate() === now.getDate();
    }

    function updateCounters() {
      countTravel.textContent = travelCount;
      countFood.textContent = foodCount;
      countTravel2.textContent = travelCount;
      countFood2.textContent = foodCount;
    }

    // ---- äº’å‹• ----
    bubble.addEventListener("click", () => {
      const msg = bubbleMessages[Math.floor(Math.random() * bubbleMessages.length)];
      bubble.textContent = msg;
    });

    tabButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        tabButtons.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        const tab = btn.dataset.tab;
        if (tab === "travel") {
          panelTravel.classList.add("active");
          panelFood.classList.remove("active");
        } else {
          panelFood.classList.add("active");
          panelTravel.classList.remove("active");
        }
      });
    });

    mapBtns.forEach(btn => {
      btn.addEventListener("click", () => {
        mapBtns.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
      });
    });

    typeBtns.forEach(btn => {
      btn.addEventListener("click", () => {
        typeBtns.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
      });
    });

    let dayValue = 2;
    function refreshDayDisplay() {
      dayDisplay.textContent = dayValue + " å¤©";
    }
    dayMinus.addEventListener("click", () => {
      if (dayValue > 1) {
        dayValue--;
        refreshDayDisplay();
      }
    });
    dayPlus.addEventListener("click", () => {
      if (dayValue < 5) {
        dayValue++;
        refreshDayDisplay();
      }
    });

    function getSelectedRegion() {
      const active = document.querySelector(".map-btn.active");
      return active ? active.dataset.region : "all";
    }
    function getSelectedType() {
      const active = document.querySelector("#typeRow .pill-btn.active");
      return active ? active.dataset.type : "all";
    }

    function triggerPlusOne(symbolText) {
      plusOne.textContent = "+1 " + symbolText;
      plusOne.classList.remove("show");
      void plusOne.offsetWidth;
      plusOne.classList.add("show");
    }

    // ---- æŠ½æ—…éŠç±¤ ----
    drawTravelBtn.addEventListener("click", () => {
      const region = getSelectedRegion();
      const type = getSelectedType();
      const days = dayValue;

      let pool = region === "all" ? attractions : attractions.filter(a => a.region === region);

      let filtered = pool.filter(a =>
        days >= a.minDays && days <= a.maxDays &&
        (type === "all" || a.types.includes(type))
      );
      if (!filtered.length) {
        filtered = pool.filter(a => type === "all" || a.types.includes(type));
      }
      if (!filtered.length) filtered = pool;

      const picked = filtered[Math.floor(Math.random() * filtered.length)];
      loadingLine.style.display = "flex";
      drawTravelBtn.disabled = true;

      setTimeout(() => {
        loadingLine.style.display = "none";
        drawTravelBtn.disabled = false;
        travelCount++;
        updateCounters();
        triggerPlusOne("ğŸ§³");
        const now = new Date().toISOString();
        const record = {
          kind: "travel",
          time: now,
          name: picked.name,
          city: picked.city,
          regionLabel: picked.regionLabel,
          daysWanted: days,
          daysRange: `${picked.minDays}â€“${picked.maxDays}`,
          type,
          tags: picked.tags,
          tip: picked.tip
        };
        travelHistory.unshift(record);
        if (travelHistory.length > 30) travelHistory.pop();
        saveHistory();
        openResultModal("travel", record);
      }, 900);
    });

    // ---- æŠ½ç¾é£Ÿç±¤ ----
    drawFoodBtn.addEventListener("click", () => {
      const region = getSelectedRegion();
      const type = getSelectedType();

      let pool = region === "all" ? foods : foods.filter(f => f.region === region);
      let filtered = pool.filter(f => type === "all" || f.types.includes(type));
      if (!filtered.length) filtered = pool;

      const picked = filtered[Math.floor(Math.random() * filtered.length)];
      loadingLineFood.style.display = "flex";
      drawFoodBtn.disabled = true;

      setTimeout(() => {
        loadingLineFood.style.display = "none";
        drawFoodBtn.disabled = false;
        foodCount++;
        updateCounters();
        triggerPlusOne("ğŸ´");
        const now = new Date().toISOString();
        const record = {
          kind: "food",
          time: now,
          name: picked.name,
          city: picked.city,
          regionLabel: picked.regionLabel,
          type,
          tags: picked.tags,
          tip: picked.tip
        };
        foodHistory.unshift(record);
        if (foodHistory.length > 30) foodHistory.pop();
        saveHistory();
        openResultModal("food", record);
      }, 900);
    });

    // ---- Modal é¡¯ç¤º ----
    function openResultModal(kind, record) {
      const dateStr = new Date(record.time).toLocaleString("zh-TW", { hour12:false });
      if (kind === "travel") {
        resultTitle.textContent = "æ—…éŠç±¤çµæœ";
        resultSub.textContent = `æŠ½ç±¤æ™‚é–“ï¼š${dateStr} ï½œ ${record.regionLabel} ï½œ æƒ³ç©ç´„ ${record.daysWanted} å¤©`;
        resultMain.textContent = `${record.name}\nä½åœ¨ï¼š${record.city}\nå»ºè­°åœç•™ï¼š${record.daysRange} å¤©`;
      } else {
        resultTitle.textContent = "ç¾é£Ÿç±¤çµæœ";
        resultSub.textContent = `æŠ½ç±¤æ™‚é–“ï¼š${dateStr} ï½œ ${record.regionLabel}`;
        resultMain.textContent = `${record.name}\næ¨è–¦åœ°é»ï¼š${record.city}`;
      }

      resultTags.innerHTML = "";
      (record.tags || []).forEach(t => {
        const span = document.createElement("span");
        span.className = "tag";
        span.textContent = "#" + t;
        resultTags.appendChild(span);
      });
      resultTip.textContent = record.tip || "";
      resultModal.style.display = "flex";
    }

    function openHistoryModal() {
      historyTravelList.innerHTML = "";
      historyFoodList.innerHTML = "";

      if (!travelHistory.length) {
        historyTravelList.innerHTML = '<div style="font-size:12px;color:#b08a62;">ç›®å‰é‚„æ²’æœ‰æ—…éŠç´€éŒ„ï½</div>';
      } else {
        travelHistory.slice(0, 20).forEach(r => {
          const d = new Date(r.time);
          const item = document.createElement("div");
          item.className = "history-item";
          item.innerHTML = `
            <div class="history-item-head">ğŸ“ ${r.name}</div>
            <div class="history-item-meta">
              ${d.toLocaleString("zh-TW",{hour12:false})} ï½œ ${r.regionLabel} ï½œ æƒ³ç© ${r.daysWanted} å¤©ï¼ˆå»ºè­° ${r.daysRange} å¤©ï¼‰
            </div>
            <div>${r.city}</div>
          `;
          historyTravelList.appendChild(item);
        });
      }

      if (!foodHistory.length) {
        historyFoodList.innerHTML = '<div style="font-size:12px;color:#b08a62;">ç›®å‰é‚„æ²’æœ‰ç¾é£Ÿç´€éŒ„ï½</div>';
      } else {
        foodHistory.slice(0, 20).forEach(r => {
          const d = new Date(r.time);
          const item = document.createElement("div");
          item.className = "history-item";
          item.innerHTML = `
            <div class="history-item-head">ğŸ´ ${r.name}</div>
            <div class="history-item-meta">
              ${d.toLocaleString("zh-TW",{hour12:false})} ï½œ ${r.regionLabel}
            </div>
            <div>${r.city}</div>
          `;
          historyFoodList.appendChild(item);
        });
      }

      historyModal.style.display = "flex";
    }

    document.querySelectorAll(".modal-close").forEach(btn => {
      btn.addEventListener("click", () => {
        const id = btn.dataset.close;
        document.getElementById(id).style.display = "none";
      });
    });

    resultModal.addEventListener("click", e => {
      if (e.target === resultModal) resultModal.style.display = "none";
    });
    historyModal.addEventListener("click", e => {
      if (e.target === historyModal) historyModal.style.display = "none";
    });

    historyBtn.addEventListener("click", openHistoryModal);
    historyBtn2.addEventListener("click", openHistoryModal);

    // åˆå§‹åŒ–
    loadHistoryFromStorage();
    refreshDayDisplay();
  </script>
</body>
</html>