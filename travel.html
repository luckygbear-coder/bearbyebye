<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>æ„›åƒç†Šæ—…éŠéˆæ„Ÿæ©Ÿ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      margin: 0;
      padding: 0;
      background: #fff3d8;
      font-family: "Noto Sans TC", -apple-system, BlinkMacSystemFont, sans-serif;
    }

    .app-wrap {
      max-width: 480px;
      margin: 0 auto;
      padding: 16px;
    }

    .card {
      background: #fffbf2;
      border-radius: 18px;
      border: 2px solid #f0c57a;
      box-shadow: 0 4px 10px rgba(0,0,0,0.08);
      padding: 16px;
    }

    .title-row {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 12px;
    }

    .bear-avatar {
      width: 64px;
      height: 64px;
      border-radius: 50%;
      background: #ffe0b5 url("images/food-bear.png") center/cover no-repeat;
      border: 2px solid #f29f74;
      flex-shrink: 0;
    }

    .title-text {
      flex: 1;
    }

    .title-text h1 {
      margin: 0;
      font-size: 20px;
      color: #7a4329;
    }

    .title-text p {
      margin: 4px 0 0;
      font-size: 13px;
      color: #9b5b36;
    }

    /* ç†Šç†Šæ°£æ³¡ï¼ˆé»æ“Šæ›ä¸€å¥è©±ï¼‰ */
    .bubble {
      position: relative;
      margin-top: 10px;
      background: #fff;
      border-radius: 14px;
      padding: 10px 12px;
      border: 2px solid #f7cfa4;
      font-size: 13px;
      color: #6a3b3b;
      cursor: pointer;
    }

    .bubble::after {
      content: "";
      position: absolute;
      left: 26px;
      top: 100%;
      border-width: 8px;
      border-style: solid;
      border-color: #f7cfa4 transparent transparent transparent;
    }

    .bubble::before {
      content: "";
      position: absolute;
      left: 27px;
      top: calc(100% - 2px);
      border-width: 8px;
      border-style: solid;
      border-color: #fff transparent transparent transparent;
    }

    .section-title {
      margin: 16px 0 8px;
      font-size: 15px;
      color: #7a4329;
      font-weight: 700;
    }

    /* å€åŸŸæŒ‰éˆ•åˆ— */
    .chip-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .chip {
      padding: 6px 12px;
      border-radius: 999px;
      border: 1.5px solid #f1c288;
      font-size: 13px;
      background: #fffaf1;
      color: #8b4a33;
      cursor: pointer;
      transition: transform 0.1s ease, box-shadow 0.1s ease, background 0.1s ease;
    }

    .chip span {
      margin-right: 4px;
    }

    .chip.active {
      background: #ffcf84;
      color: #5c321c;
      box-shadow: 0 2px 6px rgba(0,0,0,0.15);
      transform: translateY(-1px);
      border-color: #e39743;
    }

    /* å¤©æ•¸é¸æ“‡ */
    .days-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .day-chip {
      padding: 6px 10px;
      border-radius: 999px;
      border: 1.5px solid #e2b28c;
      font-size: 13px;
      background: #fff;
      color: #74412c;
      cursor: pointer;
      transition: 0.1s ease;
    }

    .day-chip.active {
      background: #ffd79a;
      color: #4b2612;
      border-color: #d28f5d;
      box-shadow: 0 2px 5px rgba(0,0,0,0.13);
      transform: translateY(-1px);
    }

    /* æŠ½éˆæ„ŸæŒ‰éˆ• */
    .action-wrap {
      margin-top: 16px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }

    .btn-main {
      flex: 1;
      border: none;
      border-radius: 999px;
      padding: 10px 16px;
      background: linear-gradient(135deg, #ffb86b, #ff9b73);
      color: #fff;
      font-weight: 700;
      font-size: 15px;
      letter-spacing: 1px;
      box-shadow: 0 4px 12px rgba(255,140,82,0.45);
      cursor: pointer;
      transition: transform 0.1s ease, box-shadow 0.1s ease;
    }

    .btn-main:active {
      transform: translateY(1px);
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    }

    .counter-pill {
      font-size: 12px;
      color: #9b5b36;
      background: #ffe8c9;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px dashed #e0a86b;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      white-space: nowrap;
    }

    .counter-pill span {
      font-size: 15px;
    }

    /* +1 å‹•ç•«å­—æ¨£ */
    .plus-one {
      position: absolute;
      right: 24px;
      bottom: 48px;
      font-size: 16px;
      color: #ff7b59;
      font-weight: 700;
      opacity: 0;
      transform: translateY(8px);
      pointer-events: none;
    }

    .plus-one.show {
      animation: riseFade 0.9s ease-out forwards;
    }

    @keyframes riseFade {
      0% { opacity: 0; transform: translateY(8px); }
      20% { opacity: 1; }
      100% { opacity: 0; transform: translateY(-20px); }
    }

    /* çµæœå€ */
    .result-card {
      margin-top: 16px;
      background: #fff7ea;
      border-radius: 18px;
      border: 2px solid #f3c690;
      padding: 14px;
      box-shadow: 0 5px 14px rgba(0,0,0,0.18);
    }

    .result-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 6px;
      gap: 8px;
    }

    .result-header h2 {
      margin: 0;
      font-size: 18px;
      color: #7a4329;
    }

    .badge-region {
      font-size: 12px;
      background: #ffe0b5;
      border-radius: 999px;
      padding: 4px 8px;
      color: #6b3a25;
    }

    .result-meta {
      font-size: 13px;
      color: #8b5a3a;
      margin-bottom: 6px;
    }

    .tag-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-bottom: 8px;
    }

    .tag {
      font-size: 11px;
      padding: 4px 8px;
      border-radius: 999px;
      background: #ffeedd;
      color: #8b4a33;
    }

    .bear-tip-title {
      font-size: 13px;
      font-weight: 700;
      color: #7a4329;
      margin-top: 4px;
      margin-bottom: 4px;
    }

    .bear-tip-text {
      font-size: 13px;
      color: #6a3b3b;
      line-height: 1.6;
      white-space: pre-line;
    }

    /* ç­‰å¾…å‹•ç•« */
    .loading {
      margin-top: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      font-size: 13px;
      color: #9b5b36;
    }

    .dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: #ff9f6b;
      animation: bounce 0.8s infinite alternate;
    }

    .dot:nth-child(2) { animation-delay: 0.15s; }
    .dot:nth-child(3) { animation-delay: 0.3s; }

    @keyframes bounce {
      from { transform: translateY(0); opacity: 0.5; }
      to { transform: translateY(-6px); opacity: 1; }
    }

    /* æ­·å²ç´€éŒ„ */
    .history-card {
      margin-top: 14px;
      padding: 10px 12px;
      border-radius: 14px;
      border: 1.5px dashed #e0b88d;
      background: #fffaf3;
      max-height: 120px;
      overflow-y: auto;
      font-size: 12px;
      color: #7a4329;
    }

    .history-item {
      padding: 6px 0;
      border-bottom: 1px dashed #f1d4aa;
    }

    .history-item:last-child {
      border-bottom: none;
    }

    .history-item-title {
      font-weight: 700;
      margin-bottom: 2px;
    }

    .history-item-meta {
      font-size: 11px;
      color: #9b5b36;
    }

    .history-empty {
      font-size: 12px;
      color: #b08a62;
    }

    @media (max-width: 360px) {
      .title-text h1 {
        font-size: 18px;
      }
      .bear-avatar {
        width: 56px;
        height: 56px;
      }
    }
  </style>
</head>
<body>
  <div class="app-wrap">
    <div class="card" style="position: relative;">
      <div class="title-row">
        <div class="bear-avatar"></div>
        <div class="title-text">
          <h1>æ„›åƒç†Šæ—…éŠéˆæ„Ÿæ©Ÿ</h1>
          <p>é¸ä¸€å€‹åœ°å€å’Œå¤©æ•¸ï¼Œè®“æ„›åƒç†Šå¹«ä½ æŠ½å‡ºä¸‹ä¸€è¶Ÿå°æ—…è¡Œ ğŸ§³</p>
        </div>
      </div>

      <div class="bubble" id="bubble">
        ğŸ» é»æˆ‘ä¸€ä¸‹ï¼Œè½è½ä»Šå¤©æ„›åƒç†Šçš„æ—…éŠå°èªï½
      </div>

      <div class="section-title">1ï¸âƒ£ æƒ³å»å“ªä¸€å¸¶ç©ï¼Ÿ</div>
      <div class="chip-row" id="regionChips">
        <button class="chip active" data-region="all"><span>ğŸ²</span>å…¨å°éš¨æ©Ÿ</button>
        <button class="chip" data-region="north"><span>ğŸ»</span>åŒ—éƒ¨</button>
        <button class="chip" data-region="central"><span>ğŸŒ¾</span>ä¸­éƒ¨</button>
        <button class="chip" data-region="south"><span>ğŸŒ´</span>å—éƒ¨</button>
        <button class="chip" data-region="east"><span>ğŸï¸</span>æ±éƒ¨</button>
        <button class="chip" data-region="islands"><span>ğŸŒŠ</span>å¤–å³¶</button>
      </div>

      <div class="section-title">2ï¸âƒ£ æƒ³ç©å¹¾å¤©å‘¢ï¼Ÿ</div>
      <div class="days-row" id="daysRow">
        <button class="day-chip active" data-days="1">1 å¤©å°æ•£æ­¥</button>
        <button class="day-chip" data-days="2">2 å¤©è¼•æ—…è¡Œ</button>
        <button class="day-chip" data-days="3">3 å¤©å°åº¦å‡</button>
        <button class="day-chip" data-days="4">4 å¤©ä»¥ä¸Šé•·ä¸€é»</button>
        <button class="day-chip" data-days="auto">ä¸çŸ¥é“ï¼Œè«‹æ„›åƒç†Šæ±ºå®š</button>
      </div>

      <div class="action-wrap">
        <button class="btn-main" id="drawBtn">å¹«æˆ‘æŠ½æ—…éŠéˆæ„Ÿ âœ¨</button>
        <div class="counter-pill">
          <span>ğŸ“</span>
          ä»Šå¤©å·²æŠ½ <span id="countNum">0</span> æ¬¡
        </div>
      </div>

      <div class="plus-one" id="plusOne">+1 ğŸ’</div>

      <div id="loading" class="loading" style="display:none;">
        æ„›åƒç†Šç¿»æ‰¾æ—…éŠé»å­ä¸­â€¦
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
      </div>

      <div id="resultArea" class="result-card" style="display:none;">
        <div class="result-header">
          <h2 id="spotName">æ™¯é»åç¨±</h2>
          <div class="badge-region" id="spotRegion">åœ°å€</div>
        </div>
        <div class="result-meta" id="spotCity"></div>
        <div class="result-meta" id="spotDays"></div>
        <div class="tag-row" id="tagRow"></div>
        <div class="bear-tip-title">ğŸ» æ„›åƒç†Šæš–å¿ƒæé†’</div>
        <div class="bear-tip-text" id="bearTip"></div>
      </div>

      <div class="history-card">
        <div style="font-weight:700; margin-bottom:4px;">ğŸ“ æœ€è¿‘ 3 æ¬¡æ—…éŠéˆæ„Ÿ</div>
        <div id="historyList" class="history-empty">
          é‚„æ²’æœ‰ç´€éŒ„ï¼Œå…ˆè®“æ„›åƒç†Šå¹«ä½ æŠ½ä¸€å¼µæ—…éŠç±¤å§ï½
        </div>
      </div>
    </div>
  </div>

  <script>
    // æ—…éŠæ™¯é»è³‡æ–™ï¼ˆå¯ä»¥ä¹‹å¾Œå†æ…¢æ…¢è£œï¼‰
    const attractions = [
      // åŒ—éƒ¨
      {
        name: "ä¹ä»½è€è¡— & é‡‘ç“œçŸ³å±±åŸ",
        region: "north",
        regionLabel: "åŒ—éƒ¨",
        city: "æ–°åŒ—å¸‚ç‘èŠ³å€",
        minDays: 1,
        maxDays: 2,
        tags: ["å±±åŸå··å¼„", "è€è¡—ç¾é£Ÿ", "å¤œæ™¯"],
        tip: "å»ºè­°å…ˆåˆ°é‡‘ç“œçŸ³èµ°èµ°ï¼Œå†å‚æ™šä¸Šä¹ä»½åƒæ™šé¤çœ‹å¤œæ™¯ã€‚å±±ä¸Šæº«å·®å¤§ï¼Œå¯ä»¥å¸¶ä»¶è–„å¤–å¥—å–”ã€‚"
      },
      {
        name: "é™½æ˜å±±åœ‹å®¶å…¬åœ’",
        region: "north",
        regionLabel: "åŒ—éƒ¨",
        city: "å°åŒ—å¸‚åŒ—æŠ•å€",
        minDays: 1,
        maxDays: 2,
        tags: ["è³èŠ±æ­¥é“", "æº«æ³‰", "è¿‘éƒŠæ•£æ­¥"],
        tip: "å¯ä»¥æ’ä¸€æ—¥ï¼šæ—©ä¸Šæ­¥é“æ•£æ­¥ï¼Œä¸‹åˆæ³¡æº«æ³‰ã€åƒç«é‹ã€‚é‹å­é¸å¥½èµ°çš„ï¼Œè®“è…³ä¹Ÿä¸€èµ·åº¦å‡ã€‚"
      },
      {
        name: "æ·¡æ°´ & æ¼äººç¢¼é ­",
        region: "north",
        regionLabel: "åŒ—éƒ¨",
        city: "æ–°åŒ—å¸‚æ·¡æ°´å€",
        minDays: 1,
        maxDays: 1,
        tags: ["æ²³å²¸å¤•é™½", "è€è¡—ç¾é£Ÿ", "è¼•é¬†æ•£æ­¥"],
        tip: "ä¸‹åˆå†å»æ·¡æ°´ï¼Œé‚Šæ•£æ­¥é‚Šåƒå°åƒï¼Œçœ‹å¤•é™½æ…¢æ…¢è®Šè‰²ï¼Œè®“å¿ƒæƒ…ä¹Ÿè·Ÿè‘—æ”¾é¬†ä¸‹ä¾†ã€‚"
      },

      // ä¸­éƒ¨
      {
        name: "æ—¥æœˆæ½­ç’°æ¹–å°æ—…è¡Œ",
        region: "central",
        regionLabel: "ä¸­éƒ¨",
        city: "å—æŠ•ç¸£é­šæ± é„‰",
        minDays: 2,
        maxDays: 3,
        tags: ["æ¹–æ™¯å–®è»Š", "çºœè»Š", "æ…¢æ´»åº¦å‡"],
        tip: "å¯ä»¥ç§Ÿè…³è¸è»Šæ…¢æ…¢ç’°æ¹–ï¼Œæ­é…èˆ¹ç¥¨èˆ‡çºœè»Šï¼Œä¸€æ¬¡æ”¶é›†ä¸ä¸€æ¨£çš„æ—¥æœˆæ½­é¢¨æ™¯ã€‚è¡Œæè¶Šè¼•ï¼Œå¿ƒä¹Ÿè¶Šè¼•ã€‚"
      },
      {
        name: "æ¸…å¢ƒè¾²å ´ & åˆæ­¡å±±è§€æ˜Ÿ",
        region: "central",
        regionLabel: "ä¸­éƒ¨",
        city: "å—æŠ•ç¸£ä»æ„›é„‰",
        minDays: 2,
        maxDays: 3,
        tags: ["é’é’è‰åŸ", "é«˜å±±æ˜Ÿç©º", "æ¶¼çˆ½é¿æš‘"],
        tip: "ç™½å¤©çœ‹ç¾Šå’©å’©åƒè‰ï¼Œæ™šä¸Šçœ‹æ»¿å¤©æ˜Ÿæ˜Ÿã€‚å±±ä¸Šæº«åº¦åä½ï¼Œè¨˜å¾—å¸¶å¤–å¥—èˆ‡ä¿æš–è¥ªå­ã€‚"
      },
      {
        name: "å°ä¸­å¸‚å€ & å½©è™¹çœ·æ‘",
        region: "central",
        regionLabel: "ä¸­éƒ¨",
        city: "å°ä¸­å¸‚å—å±¯å€å‘¨é‚Š",
        minDays: 1,
        maxDays: 2,
        tags: ["æ–‡å‰µèšè½", "å’–å•¡å»³", "è¦ªå­å‹å–„"],
        tip: "å®‰æ’è¼•é¬†çš„åŸå¸‚æ•£æ­¥ï¼šå½©è™¹çœ·æ‘ã€å¯©è¨ˆæ–°æ‘ã€è‰æ‚Ÿé“ã€‚é¤“äº†å°±åœä¸‹ä¾†åƒä¸€é»ï¼Œå†èµ°ä¸€é»ã€‚"
      },

      // å—éƒ¨
      {
        name: "å¢¾ä¸æµ·é‚Šè—å¤©å‡æœŸ",
        region: "south",
        regionLabel: "å—éƒ¨",
        city: "å±æ±ç¸£æ†æ˜¥é®",
        minDays: 2,
        maxDays: 4,
        tags: ["æ²™ç˜æˆ²æ°´", "åœ‹å®¶å…¬åœ’", "æµ·é¢¨å¹é¢¨"],
        tip: "æ—©ä¸Šç©æ°´ã€ä¸‹åˆå¹æµ·é¢¨ã€æ™šä¸Šçœ‹æ˜Ÿæ˜Ÿã€‚è¨˜å¾—é˜²æ›¬èˆ‡è£œå……æ°´ä»½ï¼Œæ›¬é»‘æ²’é—œä¿‚ï¼Œé–‹å¿ƒæœ€é‡è¦ã€‚"
      },
      {
        name: "é«˜é›„é§äºŒ & æ„›æ²³æ•£æ­¥",
        region: "south",
        regionLabel: "å—éƒ¨",
        city: "é«˜é›„å¸‚é¹½åŸ•å€",
        minDays: 1,
        maxDays: 2,
        tags: ["æ¸¯éƒ½å¸‚æ™¯", "æ–‡å‰µå±•è¦½", "å¤œæ™¯æ•£æ­¥"],
        tip: "ç™½å¤©é€›é§äºŒã€æ™šä¸Šåˆ°æ„›æ²³èµ°èµ°ï¼Œæ‰¾å€‹ä½ç½®åä¸‹ä¾†çœ‹åŸå¸‚çš„ç‡ˆå…‰ï¼Œä¹Ÿçœ‹çœ‹æœ€è¿‘çš„è‡ªå·±ã€‚"
      },
      {
        name: "å°å—å··å¼„ç¾é£Ÿä¹‹æ—…",
        region: "south",
        regionLabel: "å—éƒ¨",
        city: "å°å—å¸‚ä¸­è¥¿å€å‘¨é‚Š",
        minDays: 2,
        maxDays: 3,
        tags: ["å°åƒå¤©å ‚", "å¤è¹Ÿè€å±‹", "æ…¢æ­¥æ—…è¡Œ"],
        tip: "ä¸€æ¬¡åƒä¸å®Œæ²’é—œä¿‚ï¼Œé€™åº§åŸå¸‚æœƒç­‰ä½ å›ä¾†ã€‚æ—…é€”ä¸­ï¼Œè¨˜å¾—å°ä¸€èµ·åƒæ±è¥¿çš„äººèªªè²è¬è¬ã€‚"
      },

      // æ±éƒ¨
      {
        name: "èŠ±è“®å¤ªé­¯é–£å³½è°·ä¹‹æ—…",
        region: "east",
        regionLabel: "æ±éƒ¨",
        city: "èŠ±è“®ç¸£ç§€æ—é„‰",
        minDays: 2,
        maxDays: 3,
        tags: ["å³½è°·æ­¥é“", "å±±æµ·æ™¯ç·»", "è‡ªç„¶ç™‚ç™’"],
        tip: "æ­¥é“å¤šç‚ºçŸ³éšèˆ‡å±±è·¯ï¼Œé‹å­è¦ç©©ï¼Œè…³æ­¥æ”¾æ…¢ã€‚æ¯å¸ä¸€å£æ°£ï¼Œéƒ½æŠŠç…©æƒ±å…ˆæ”¾åœ¨å±±ä¸‹ã€‚"
      },
      {
        name: "èŠ±æ±ç¸±è°·å°ç«è»Š",
        region: "east",
        regionLabel: "æ±éƒ¨",
        city: "èŠ±è“®â€“å°æ±ä¸€å¸¶",
        minDays: 3,
        maxDays: 4,
        tags: ["ç¨»ç”°é¢¨æ™¯", "å°é®æ—…é¤¨", "é¨è…³è¸è»Š"],
        tip: "å¯ä»¥æŒ‘ä¸€å…©å€‹å°é®å¤šå¾…ä¸€å¤©ï¼Œè®“è‡ªå·±æœ‰çœŸæ­£ç™¼å‘†çš„æ™‚é–“ã€‚ç™¼å‘†ï¼Œä¹Ÿæ˜¯å¾ˆé‡è¦çš„è¡Œç¨‹ã€‚"
      },
      {
        name: "å°æ±æµ·ç·šæ”¾ç©ºä¹‹æ—…",
        region: "east",
        regionLabel: "æ±éƒ¨",
        city: "å°æ±ç¸£æˆåŠŸé®ãƒ»é•·æ¿±é„‰ä¸€å¸¶",
        minDays: 2,
        maxDays: 3,
        tags: ["æµ·å²¸å…¬è·¯", "çœ‹æ—¥å‡º", "å’–å•¡å°åº—"],
        tip: "æ—©èµ·çœ‹ä¸€æ¬¡æµ·é‚Šæ—¥å‡ºï¼Œæé†’è‡ªå·±ï¼šæ–°çš„é–‹å§‹å…¶å¯¦æ¯å¤©éƒ½æœ‰ã€‚"
      },

      // å¤–å³¶
      {
        name: "æ¾æ¹–è·³å³¶æµ·é¢¨æ—…è¡Œ",
        region: "islands",
        regionLabel: "å¤–å³¶",
        city: "æ¾æ¹–ç¸£é¦¬å…¬å¸‚ä¸€å¸¶",
        minDays: 3,
        maxDays: 4,
        tags: ["æµ·ä¸Šæ´»å‹•", "ç„æ­¦å²©åœ°å½¢", "å¤œé–“çœ‹æ˜Ÿæ˜Ÿ"],
        tip: "è¡Œç¨‹ä¸è¦å¡å¤ªæ»¿ï¼Œç•™ä¸€äº›æ™‚é–“åªæ˜¯åè‘—çœ‹æµ·ï¼Œè·Ÿè‡ªå·±å¥½å¥½èŠå¤©ã€‚"
      },
      {
        name: "å°ç‰çƒæµ·é¾œæ…¢æ´»æ—¥å¸¸",
        region: "islands",
        regionLabel: "å¤–å³¶",
        city: "å±æ±ç¸£ç‰çƒé„‰",
        minDays: 2,
        maxDays: 3,
        tags: ["æµ®æ½›çœ‹æµ·é¾œ", "ç’°å³¶æ©Ÿè»Š", "å°å³¶æ­¥èª¿"],
        tip: "è·Ÿæµ·é¾œä¸€æ¨£æ…¢æ…¢æ¸¸ã€æ…¢æ…¢å‘¼å¸ã€‚è¨˜å¾—ä¿æŒè·é›¢ï¼Œä¸æ‰“æ“¾ç‰ å€‘çš„ç”Ÿæ´»ï¼Œå°±æ˜¯æœ€æº«æŸ”çš„ç›¸é‡ã€‚"
      },
      {
        name: "ç¶ å³¶æº«æ³‰èˆ‡å¤œè§€é¹¿",
        region: "islands",
        regionLabel: "å¤–å³¶",
        city: "å°æ±ç¸£ç¶ å³¶é„‰",
        minDays: 2,
        maxDays: 3,
        tags: ["æµ·å²¸é¢¨æ™¯", "æµ·åº•ä¸–ç•Œ", "æµ·é‚Šæº«æ³‰"],
        tip: "å¯ä»¥å®‰æ’å¤œè§€æ¢…èŠ±é¹¿ã€ç™½å¤©æ½›æ°´æˆ–æµ®æ½›ã€‚å›åˆ°æ°‘å®¿æ´—å®Œæ¾¡å¾Œï¼Œå¯«ä¸€è¡Œä»Šå¤©æœ€æ„Ÿè¬çš„äº‹é€çµ¦è‡ªå·±ã€‚"
      }
    ];

    // ç†Šç†Šéš¨æ©Ÿå°èªï¼ˆæ—…éŠç‰ˆï¼‰
    const bubbleMessages = [
      "ğŸ» ç†Šç†Šèªªï¼šä¸æ˜¯ä¸€å®šè¦èµ°å¾ˆé ï¼Œèƒ½è®“ä½ è¦ºå¾—æ”¾é¬†çš„åœ°æ–¹ï¼Œå°±æ˜¯å¥½åœ°æ–¹ã€‚",
      "ğŸ» ç†Šç†Šèªªï¼šè¡Œç¨‹æ’ä¸€é»ç©ºç™½ï¼Œè®“é©šå–œæœ‰æ©Ÿæœƒæ’éšŠé€²ä¾†å‘€ã€‚",
      "ğŸ» ç†Šç†Šèªªï¼šç´¯äº†å°±æ…¢ä¸€é»ï¼Œæ—…è¡Œä¸æ˜¯æ¯”é€Ÿåº¦ï¼Œè€Œæ˜¯çœ‹ä½ æœ‰æ²’æœ‰å¥½å¥½æ„Ÿå—ã€‚",
      "ğŸ» ç†Šç†Šèªªï¼šè·Ÿåœ¨ä¹çš„äººä¸€èµ·åƒä¸€é “é£¯ï¼Œå°±æ˜¯å¾ˆæ£’çš„æ—…éŠè¡Œç¨‹ã€‚",
      "ğŸ» ç†Šç†Šèªªï¼šå°±ç®—åªæ˜¯ä¸€æ—¥å°æ•£æ­¥ï¼Œä¹Ÿæ˜¯åœ¨ç‚ºè‡ªå·±å……é›»å–”ã€‚"
    ];

    const bubble = document.getElementById("bubble");
    const regionChips = document.querySelectorAll("#regionChips .chip");
    const dayChips = document.querySelectorAll("#daysRow .day-chip");
    const drawBtn = document.getElementById("drawBtn");
    const loadingEl = document.getElementById("loading");
    const resultArea = document.getElementById("resultArea");
    const countNum = document.getElementById("countNum");
    const plusOne = document.getElementById("plusOne");
    const historyList = document.getElementById("historyList");

    const spotName = document.getElementById("spotName");
    const spotRegion = document.getElementById("spotRegion");
    const spotCity = document.getElementById("spotCity");
    const spotDays = document.getElementById("spotDays");
    const tagRow = document.getElementById("tagRow");
    const bearTip = document.getElementById("bearTip");

    let drawCount = 0;
    let history = [];

    // é»æ°£æ³¡æ›å¥è©±
    bubble.addEventListener("click", () => {
      const msg = bubbleMessages[Math.floor(Math.random() * bubbleMessages.length)];
      bubble.textContent = msg;
    });

    // å€åŸŸ chip åˆ‡æ›
    regionChips.forEach(chip => {
      chip.addEventListener("click", () => {
        regionChips.forEach(c => c.classList.remove("active"));
        chip.classList.add("active");
      });
    });

    // å¤©æ•¸ chip åˆ‡æ›
    dayChips.forEach(chip => {
      chip.addEventListener("click", () => {
        dayChips.forEach(c => c.classList.remove("active"));
        chip.classList.add("active");
      });
    });

    // å–å¾—ç›®å‰é¸æ“‡
    function getSelectedRegion() {
      const active = document.querySelector("#regionChips .chip.active");
      return active ? active.dataset.region : "all";
    }

    function getSelectedDays() {
      const active = document.querySelector("#daysRow .day-chip.active");
      return active ? active.dataset.days : "1";
    }

    // æŠ½æ™¯é»ä¸»æµç¨‹
    drawBtn.addEventListener("click", () => {
      const region = getSelectedRegion();
      let days = getSelectedDays();

      // è‡ªå‹•æ±ºå®šå¤©æ•¸
      if (days === "auto") {
        const randomDays = [1,2,3,4][Math.floor(Math.random() * 4)];
        days = String(randomDays);
      }

      const daysNum = parseInt(days, 10);

      // å»ºç«‹å€™é¸æ¸…å–®
      let pool = attractions;
      if (region !== "all") {
        pool = attractions.filter(a => a.region === region);
      }

      // å…ˆç”¨å¤©æ•¸ç¯©é¸ï¼Œæ‰¾ minDays~maxDays åŒ…å«çš„
      let filtered = pool.filter(a => daysNum >= a.minDays && daysNum <= a.maxDays);
      // å¦‚æœå‰›å¥½æ²’æœ‰ç¬¦åˆï¼Œå°±é€€å›æ•´å€‹ pool éš¨æ©Ÿ
      if (filtered.length === 0) filtered = pool;

      // æŠ½ä¸€å€‹
      const picked = filtered[Math.floor(Math.random() * filtered.length)];

      // é¡¯ç¤ºç­‰å¾…å‹•ç•«ï¼Œæ¨¡æ“¬ã€ŒæŠ½ç±¤ã€æ„Ÿ
      resultArea.style.display = "none";
      loadingEl.style.display = "flex";
      drawBtn.disabled = true;

      setTimeout(() => {
        loadingEl.style.display = "none";
        showResult(picked, daysNum);
        drawBtn.disabled = false;
        addCount();
        updateHistory(picked, daysNum);
      }, 900); // 0.9 ç§’æŠ½ç±¤æ„Ÿ
    });

    function showResult(spot, daysNum) {
      spotName.textContent = spot.name;
      spotRegion.textContent = spot.regionLabel;
      spotCity.textContent = `ğŸ“ ä½åœ¨ï¼š${spot.city}`;
      let dayText = `å»ºè­°åœç•™ï¼š${spot.minDays}â€“${spot.maxDays} å¤©`;

      if (daysNum) {
        dayText += `ï¼ˆä½ ç¾åœ¨æƒ³ç©ç´„ ${daysNum} å¤©ï¼‰`;
      }
      spotDays.textContent = dayText;

      tagRow.innerHTML = "";
      spot.tags.forEach(t => {
        const span = document.createElement("span");
        span.className = "tag";
        span.textContent = `#${t}`;
        tagRow.appendChild(span);
      });

      bearTip.textContent = spot.tip;
      resultArea.style.display = "block";
    }

    function addCount() {
      drawCount += 1;
      countNum.textContent = drawCount;
      plusOne.classList.remove("show");
      // é‡æ–°è§¸ç™¼å‹•ç•«
      void plusOne.offsetWidth;
      plusOne.classList.add("show");
    }

    function updateHistory(spot, daysNum) {
      const record = {
        name: spot.name,
        regionLabel: spot.regionLabel,
        daysText: `${spot.minDays}â€“${spot.maxDays} å¤©ï¼ˆä½ æƒ³ ${daysNum} å¤©ï¼‰`
      };
      history.unshift(record);
      if (history.length > 3) history.pop();

      if (!history.length) {
        historyList.className = "history-empty";
        historyList.textContent = "é‚„æ²’æœ‰ç´€éŒ„ï¼Œå…ˆè®“æ„›åƒç†Šå¹«ä½ æŠ½ä¸€å¼µæ—…éŠç±¤å§ï½";
        return;
      }

      historyList.className = "";
      historyList.innerHTML = "";
      history.forEach(item => {
        const div = document.createElement("div");
        div.className = "history-item";
        div.innerHTML = `
          <div class="history-item-title">ğŸ“ ${item.name}</div>
          <div class="history-item-meta">${item.regionLabel} Â· å»ºè­° ${item.daysText}</div>
        `;
        historyList.appendChild(div);
      });
    }
  </script>
</body>
</html>
