<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="apple-touch-icon" href="icons/icon-512.png">

  <meta name="theme-color" content="#f4a63a">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>äº”è‡Ÿå»Ÿ-æ„›åƒç†Š</title>

  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <!-- å•Ÿå‹•ç•«é¢ -->
  <div id="loading-screen">
    <img src="images/bear-loading-couplet.png" alt="æ„›åƒç†Šå•Ÿå‹•ç•«é¢">
  </div>

  <div class="app">

    <!-- æ¨™é¡Œ -->
    <header class="header">
      <div class="title">æ„›åƒç†Šç¾é£Ÿå åœ</div>
      <div class="subtitle">ä¸æ˜¯æ­£åœ¨åƒç¾é£Ÿï¼Œå°±æ˜¯åœ¨åƒç¾é£Ÿçš„è·¯ä¸Š</div>
    </header>

    <!-- ä¸»è¦–è¦ºï¼šèƒŒæ™¯å³ç†Šç†Šåœ– -->
    <section class="temple-wrapper">
      <div class="temple-image-box">

        <!-- åŠŸå¾·å€¼è§’æ¨™ -->
        <div class="merit-badge">
          åŠŸå¾·å€¼ <span id="merit">0</span>
        </div>

        <!-- æµ®å‹•æŒ‰éˆ•çµ„ -->
        <div class="floating-buttons">
          <button id="boBtn" class="circle-btn circle-main">
            ğŸ™<span>æ“²ç­Š</span>
          </button>

          <button id="drawBtn" class="circle-btn circle-main hidden">
            ğŸ§§<span>æŠ½ç±¤</span>
          </button>

          <button id="historyBtn" class="circle-btn">
            ğŸ“˜<span>ç´€éŒ„</span>
          </button>

          <button id="offerBtn" class="circle-btn small disabled">
            ğŸ±<span>ä¾›å“</span>
          </button>

          <!-- éš±è—æ¸…ç©ºæŒ‰éˆ•ï¼Œä½†ä¿ç•™ ID çµ¦ script.js ç”¨ -->
          <button id="resetBtn" class="circle-btn danger hidden">
            â™»ï¸<span>æ¸…ç©º</span>
          </button>
        </div>
      </div>
    </section>

    <!-- ç‹€æ…‹æç¤º -->
    <p id="statusText" class="status-text">
      è«‹å…ˆæ“²ç­Šï¼Œä¸€æ¬¡è–ç­Šå°±å¯ä»¥æŠ½ç±¤ï¼ˆè–ç­Šæ©Ÿç‡ 90%ï¼‰
    </p>

  </div>

  <!-- è©©ç±¤å½ˆçª— -->
  <div id="lotModal" class="modal hidden"
       onclick="if (event.target === this) window.closeAllModals();">
    <div class="modal-content">
      <div id="lotText"></div>
      <button id="closeLot" class="close-btn"
              onclick="window.closeAllModals();">
        é—œé–‰
      </button>
    </div>
  </div>

  <!-- ç´€éŒ„å½ˆçª— -->
  <div id="historyModal" class="modal hidden"
       onclick="if (event.target === this) window.closeAllModals();">
    <div class="modal-content">
      <div id="historyList"></div>
      <button id="closeHistory" class="close-btn"
              onclick="window.closeAllModals();">
        é—œé–‰
      </button>
    </div>
  </div>

  <script src="script.js"></script>

  <!-- å•Ÿå‹•ç•«é¢æ·¡å‡º + åŠŸå¾·å€¼å‹•ç•« -->
  <script>
    function hideLoadingScreen() {
      const loading = document.getElementById('loading-screen');
      if (!loading) return;
      loading.classList.add('fade-out');
      setTimeout(() => loading.remove(), 700);
    }

    window.addEventListener('load', hideLoadingScreen);
    document.addEventListener('DOMContentLoaded', () => {
      setTimeout(hideLoadingScreen, 1800);
    });

    /* åŠŸå¾· +1 é£„å­—å‹•ç•« */
    window.addMerit = function (delta) {
      const badgeValue = document.getElementById('merit');
      const current = parseInt(badgeValue.textContent || '0', 10);
      const next = current + delta;
      badgeValue.textContent = next;

      const badge = document.querySelector('.merit-badge');
      const plus = document.createElement('span');
      plus.className = 'merit-plus';
      plus.textContent = (delta > 0 ? '+' : '') + delta;
      badge.appendChild(plus);

      setTimeout(() => plus.remove(), 800);
    };

    /* å…¨åŸŸé—œé–‰å½ˆçª— */
    window.closeAllModals = function () {
      document.getElementById('lotModal').classList.add('hidden');
      document.getElementById('historyModal').classList.add('hidden');
    };
  </script>
</body>
</html>